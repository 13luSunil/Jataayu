// Top-level build file where you can add configuration options common_build to all sub-projects/modules.

buildscript {
    ext.kotlin_version = '1.3.61'

    repositories {
        google()
        jcenter()
        gradlePluginPortal()
    }

    dependencies {
        classpath Deps.toolsAndroidStudio
        classpath Deps.toolsKotlinGradle
        classpath Deps.toolsGradleVersions
        classpath Deps.toolsDicemelonJacoco
        classpath Deps.toolsJacocoCore
        classpath Deps.toolsJacocoAgent
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

allprojects {
    repositories {
        google()
        jcenter()
        maven { url 'https://jitpack.io' }
    }
}

subprojects {
    afterEvaluate { project ->
        if (project.hasProperty('android')) {
            apply plugin: "com.github.ben-manes.versions"

            //<editor-fold desc="android common DSL">
            android {
                buildToolsVersion Config.buildToolsVersion
                compileSdkVersion Config.compileSdkVersion

                defaultConfig {
                    minSdkVersion Config.minSdkVersion
                    targetSdkVersion Config.compileSdkVersion
                    testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"
                }

                compileOptions {
                    sourceCompatibility Config.javaVersion
                    targetCompatibility Config.javaVersion
                }

                buildTypes {
                    debug {}
                    qa {}
                    release {}
                }

                //<editor-fold desc="Source Sets DSL">
                sourceSets {
                    main.java.srcDirs += 'src/main/kotlin'
                    test.java.srcDirs += 'src/test/kotlin'
                    androidTest.java.srcDirs += 'src/androidTest/kotlin'

                    String sharedTestJavaDir = 'src/sharedTest/java'
                    String sharedTestResourcesDir = 'src/sharedTest/resources'

                    test {
                        java.srcDir sharedTestJavaDir
                        resources.srcDir sharedTestResourcesDir
                    }
                    androidTest {
                        java.srcDir sharedTestJavaDir
                        resources.srcDir sharedTestResourcesDir
                    }
                }
                //</editor-fold>

                kotlin {
                    experimental {
                        coroutines "enable"
                    }
                }
            }
            //</editor-fold>
            //<editor-fold desc="Common Dependancies DSL">
            dependencies {

            }
            //</editor-fold>
        }
    }
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
